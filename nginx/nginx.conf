
# O padrão é apenas um worker
worker_processes 4;

events {
    # O padrão é 1024 conexões por worker
    worker_connections  2048;
}

http {
    # Não enviar informações do servidor
    server_tokens   off;

    # Definir charset comum aos brasileiros
    charset utf-8;

    # Impedir arquivos muito grandes
    client_max_body_size    75M;

    # Servidor principal
    server {
        # Porta do servidor na rede do servidor do docker (irá ouvir pedidos na
        # rede externa, já que o docker abre 80 para o mundo através da máquina)
        listen servidor:80;

        # Servimos o /media (configurado de django-site/media pelo docker)
        location /media {
            alias /media;
        }

        # Servimos o /static (configurado de django-site/static pelo docker)
        location /static {
            alias /static;
        }

        # Qualquer outra requisição, enviamos ao django (network
        # 'server_network' configurada no docker)
        location / {
            include     /etc/nginx/uwsgi_params;
            uwsgi_pass  django-caco:8080;
        }
    }
}
